-- Services
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

-- ESP settings
local espColor = Color3.fromRGB(255, 0, 0) -- Red color for the ESP
local outlineColor = Color3.fromRGB(0, 0, 0) -- Black color for the outline
local fontSize = 28 -- Font size for the text
local chamColor = Color3.fromRGB(255, 0, 0) -- Red chams

-- Path to the Kraken
local kraken = Workspace:WaitForChild("Enemies"):WaitForChild("Kraken")

-- Create a label for the Kraken name
local nameLabel = Drawing.new("Text")
nameLabel.Visible = true
nameLabel.Text = "Kraken"
nameLabel.Size = fontSize
nameLabel.Color = espColor
nameLabel.Center = true
nameLabel.Outline = true -- Enable outline
nameLabel.OutlineColor = outlineColor -- Set outline color

-- Create a label for the Studs distance
local studsLabel = Drawing.new("Text")
studsLabel.Visible = true
studsLabel.Size = fontSize
studsLabel.Color = espColor
studsLabel.Center = true
studsLabel.Outline = true -- Enable outline
studsLabel.OutlineColor = outlineColor -- Set outline color

-- Function to update the ESP labels for name and studs
local function updateESP()
    if kraken and kraken:FindFirstChild("HumanoidRootPart") then
        local rootPart = kraken.HumanoidRootPart
        local rootPos, onScreen = Workspace.CurrentCamera:WorldToViewportPoint(rootPart.Position)

        if onScreen then
            -- Calculate distance between the player and the Kraken
            local distance = (HumanoidRootPart.Position - rootPart.Position).Magnitude

            -- Update the Kraken name and position it below the studs label
            nameLabel.Position = Vector2.new(rootPos.X, rootPos.Y - 30) -- Name slightly above the Kraken
            nameLabel.Text = "Kraken"
            nameLabel.Visible = true

            -- Update the Studs label and position it above the Kraken name
            studsLabel.Position = Vector2.new(rootPos.X, rootPos.Y - 60) -- Studs above the Kraken name
            studsLabel.Text = string.format("%.0f Studs", distance)
            studsLabel.Visible = true
        else
            nameLabel.Visible = false
            studsLabel.Visible = false
        end
    else
        nameLabel.Visible = false
        studsLabel.Visible = false
    end
end

-- Function to add Chams (Highlight) to the Kraken
local function addChams(target)
    local highlight = Instance.new("Highlight")
    highlight.Adornee = target
    highlight.FillColor = chamColor
    highlight.FillTransparency = 0.3 -- Semi-transparent chams
    highlight.OutlineColor = outlineColor -- Black outline
    highlight.OutlineTransparency = 0 -- Full opacity for the outline
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop -- Always visible, even through walls
    highlight.Parent = target
end

-- Function to remove ESP elements
local function removeESP()
    nameLabel.Visible = false
    studsLabel.Visible = false
    if kraken then
        kraken:FindFirstChild("Highlight"):Destroy() -- Remove the highlight
    end
end

-- Function to check the Kraken's health
local function checkHealth()
    while wait(1) do
        if kraken and kraken:FindFirstChild("Humanoid") then
            local humanoid = kraken.Humanoid
            if humanoid.Health <= 0 then
                removeESP()
                humanoid.Died:Wait() -- Wait until it respawns
                wait(2) -- Wait before re-adding ESP (adjust as necessary)
                addChams(kraken)
            else
                updateESP()
            end
        end
    end
end

-- Add Chams to the Kraken
addChams(kraken)

-- Start checking the Kraken's health
checkHealth()

-- Continuously update the ESP labels and distance
RunService.RenderStepped:Connect(updateESP)
